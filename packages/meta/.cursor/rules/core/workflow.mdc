# Wegoby Workflow

> **Always Apply** - Central workflow definition for all Wegoby development.

## Task Phases

```
creating â†’ researching â†’ planning â†’ implementing â†’ shipping â†’ learning â†’ done
```

Flow is **non-linear** â€” the agent can jump phases based on task complexity.

## Workflow Profiles

| Profile | Flow | When to Use |
|---------|------|-------------|
| **Full** | research â†’ plan â†’ implement â†’ ship â†’ learn | New features, refactors, complex changes |
| **Focused** | plan â†’ implement â†’ ship | Medium tasks, clear scope |
| **Quick** | implement â†’ ship | Bug fixes, small tweaks, docs |

## Command Dependency Graph

| Command | Mode | Depends On | Produces | Next |
|---------|------|------------|----------|------|
| `/help` | any | - | - | - |
| `/create-task` | agent | - | task.json | /research |
| `/research` | agent | task.json | context.md | /plan |
| `/plan` | plan | context.md | plan.md | /implement |
| `/implement` | agent | plan.md | code changes | /validate |
| `/validate` | agent | code changes | validation report | /commit |
| `/commit` | agent | validation pass | commit | /reflect |
| `/reflect` | plan | outcome | reflection | /contribute |
| `/contribute` | agent | reflection | knowledge update | done |

## Flows (Orchestrate Actions)

| Flow | Orchestrates | Purpose |
|------|--------------|---------|
| `/prepare` | research â†’ plan | Get ready to implement |
| `/ship` | validate â†’ commit â†’ summary â†’ push | Ship completed work |
| `/learn` | reflect â†’ contribute | Capture learnings |

## Pipelines (End-to-End)

| Pipeline | Variants | Full Flow |
|----------|----------|-----------|
| `/do` | `/do {task-id}` (autonomous) | prepare â†’ implement loop â†’ ship â†’ learn |
| | `/do {task-id} manually` | Same flow, waits for approval each phase |

## Error Handling

| Scenario | Behavior |
|----------|----------|
| `/validate` fails | Show errors, stay in `implementing` phase, suggest fixes |
| `/commit` fails | Show git error, allow retry or manual fix |
| `/ship` partial | Log state to `task.json`, allow resume with `/ship --resume` |
| `/do` interrupted | Save progress to `task.json`, allow resume with `/do --resume` |
| Unrecoverable error | Log to `journal.md`, suggest `/reflect` to capture learning |

**Recovery principle**: Always save state before failing, always allow resume.

## Command Output Format

Each command should end with:

```
âœ… [Phase] complete â†’ [output] created
ğŸ“ Next recommended: /[next-command]
```

## Smart Workflow Selection

When starting `/do`, analyze the task and select:

- **Bug fix with clear cause** â†’ Quick profile
- **Bug fix with unclear cause** â†’ Focused profile  
- **Small enhancement** â†’ Focused profile
- **New feature** â†’ Full profile
- **Refactor** â†’ Full profile
- **Documentation** â†’ Quick profile

## Learnings Integration

After `/reflect` and `/contribute`:
- Testing insight â†’ Added to `instructions/testing.mdc`
- Git pattern â†’ Added to `instructions/git.mdc`
- Dev pattern â†’ Added to `instructions/dev.mdc`
- Architecture decision â†’ Added to `instructions/architecture.mdc`
